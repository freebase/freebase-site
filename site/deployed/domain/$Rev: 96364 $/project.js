(function(a){a(function(){a.ajax({url:user_info_service_url||"/api/service/user_info",cache:false,dataType:"json",success:function(l){if(l){var b=a("#nav-username a:first");if(b.length){b[0].href+=l.id;b.text(l.username)}a("#signedin").show()}else a("#signedout").show()},error:function(){a("#signedout").show()}})})})(jQuery);
(function(a){a(function(){var l=a("#SearchBox .SearchBox-input,#global-search-input"),b=document.location.protocol+"//www.freebase.com";l.suggest({service_url:b,soft:true,category:"object",parent:"#site-search-box",align:"right",status:null});var m=a("#site-search-label"),f=a("#site-search-box .fbs-pane");l.bind("fb-select",function(v,w){window.location=b+"/view"+w.id;return false}).bind("fb-pane-show",function(){m.html("<span>Select an item from the list</span>").removeClass("loading")}).bind("fb-textchange",
function(){a.trim(l.val())===""?m.html("<span>Start typing to get some suggestions</span>").removeClass("loading"):m.html("<span>Searching...</span>").addClass("loading")}).bind("fb-error",function(){m.html("<span>Sorry, something went wrong. Please try again later</span>").removeClass("loading")}).focus(function(){m.is(":visible")||a("#site-search-label").slideDown("fast")}).blur(function(){!f.is(":visible")&&m.is(":visible")&&a("#site-search-label").slideUp("fast")});a(".SearchBox-form").submit(function(){return a.trim(a("#global-search-input").val()).length==
0?false:true})})})(jQuery);
$(document).ready(function(){var a={};$("img").lazyload({effect:"fadeIn",threshold:200});$("#gallery").is(":visible")&&$(this).masonry({animate:true});$(".view-mode-option").click(function(){var b=$($(this).attr("href"));if(b.is(":hidden")){$(".view-mode").fadeOut("fast");b.fadeIn("fast")}$(".view-mode-option").removeClass("selected");$(this).addClass("selected");return false});var l=$(".summary-expanded").hide();$(".summary > h2 > .more").click(function(){l.toggle("fast");$(this).text($(this).text()==
"details"?"hide":"details")});$(".collection-img > a").hover(function(){$(this).find("img").animate({left:"0"},{duration:1E3}).animate({left:"-604px"},{duration:4500,easing:"linear"})},function(){$(this).find("img").stop(true,false);$(this).find("img").animate({left:"0px"},{duration:500,easing:"swing"})});$(".collection-show-topics").click(function(){var b=$(this),m=$(this).attr("title"),f=$(this).closest(".collection"),v=f.find(".collection-topics"),w=$(this).attr("data-fb-query");if(v.is(":hidden")){$(this).addClass("expanded");
a.show_topic_panel(b,f,v,m,w)}else{$(this).removeClass("expanded");a.hide_topic_panel(f)}});$("table#collection-table").tablesorter();$("table#collection-table tbody tr:odd").addClass("odd");$(".collection").hover(function(){$(this).addClass("collection-active")},function(){$(this).removeClass("collection-active");$(this).find(".collection-show-topics").removeClass("expanded");a.hide_topic_panel($(this))});a.show_topic_panel=function(b,m,f,v,w){m.find(".collection-info").animate({top:"50px"},300);
f.slideDown(300).fadeIn(200);if(w=="false"){f.addClass("loading");$.ajax({url:"/collection-topics?id="+v,success:function(B){f.removeClass("loading").prepend(B);$more=f.find(".collection-view-all").show();b.attr("data-fb-query","true")}})}};a.hide_topic_panel=function(b){var m=$(b).find(".collection-info");b=$(b).find(".collection-topics");if(b.is(":visible")){m.animate({top:"162px"},300);b.slideUp(300).fadeOut(200)}}});
(function(a){a.fn.lazyload=function(l){var b={threshold:0,failurelimit:0,event:"scroll",effect:"show",container:window};l&&a.extend(b,l);var m=this;"scroll"==b.event&&a(b.container).bind("scroll",function(){var f=0;m.each(function(){if(!(a.abovethetop(this,b)||a.leftofbegin(this,b)))if(!a.belowthefold(this,b)&&!a.rightoffold(this,b))a(this).trigger("appear");else if(f++>b.failurelimit)return false});var v=a.grep(m,function(w){return!w.loaded});m=a(v)});this.each(function(){var f=this;undefined==a(f).attr("original")&&
a(f).attr("original",a(f).attr("src"));if("scroll"!=b.event||undefined==a(f).attr("src")||b.placeholder==a(f).attr("src")||a.abovethetop(f,b)||a.leftofbegin(f,b)||a.belowthefold(f,b)||a.rightoffold(f,b)){b.placeholder?a(f).attr("src",b.placeholder):a(f).removeAttr("src");f.loaded=false}else f.loaded=true;a(f).one("appear",function(){this.loaded||a("<img />").bind("load",function(){a(f).hide().attr("src",a(f).attr("original"))[b.effect](b.effectspeed);f.loaded=true}).attr("src",a(f).attr("original"))});
"scroll"!=b.event&&a(f).bind(b.event,function(){f.loaded||a(f).trigger("appear")})});a(b.container).trigger(b.event);return this};a.belowthefold=function(l,b){return(b.container===undefined||b.container===window?a(window).height()+a(window).scrollTop():a(b.container).offset().top+a(b.container).height())<=a(l).offset().top-b.threshold};a.rightoffold=function(l,b){return(b.container===undefined||b.container===window?a(window).width()+a(window).scrollLeft():a(b.container).offset().left+a(b.container).width())<=
a(l).offset().left-b.threshold};a.abovethetop=function(l,b){return(b.container===undefined||b.container===window?a(window).scrollTop():a(b.container).offset().top)>=a(l).offset().top+b.threshold+a(l).height()};a.leftofbegin=function(l,b){return(b.container===undefined||b.container===window?a(window).scrollLeft():a(b.container).offset().left)>=a(l).offset().left+b.threshold+a(l).width()};a.extend(a.expr[":"],{"below-the-fold":"$.belowthefold(a, {threshold : 0, container: window})","above-the-fold":"!$.belowthefold(a, {threshold : 0, container: window})",
"right-of-fold":"$.rightoffold(a, {threshold : 0, container: window})","left-of-fold":"!$.rightoffold(a, {threshold : 0, container: window})"})})(jQuery);
(function(a){var l=a.event,b;l.special.smartresize={setup:function(){a(this).bind("resize",l.special.smartresize.handler)},teardown:function(){a(this).unbind("resize",l.special.smartresize.handler)},handler:function(m,f){var v=this,w=arguments;m.type="smartresize";b&&clearTimeout(b);b=setTimeout(function(){jQuery.event.handle.apply(v,w)},f==="execAsap"?0:100)}};a.fn.smartresize=function(m){return m?this.bind("smartresize",m):this.trigger("smartresize",["execAsap"])};a.fn.masonry=function(m,f){function v(q,
o,e,r,x,y){var z=0;for(i=0;i<o;i++)if(e[i]<e[z])z=i;o={left:x.colW*z+x.posLeft,top:e[z]};x.masoned&&y.animate?q.animate(o,y.duration,y.easing):q.css(o);for(i=0;i<r;i++)x.colY[z+i]=e[z]+q.outerHeight(true)}function w(q,o,e){e.colW=o.columnWidth==undefined?e.masoned?q.data("masonry").colW:e.$bricks.outerWidth(true):o.columnWidth;e.colCount=Math.floor(q.width()/e.colW);e.colCount=Math.max(e.colCount,1)}function B(q,o,e){e.masoned||q.css("position","relative");if(!e.masoned||o.appendedContent!=undefined)e.$bricks.css("position",
"absolute");var r=a("<div />");q.prepend(r);e.posTop=Math.round(r.position().top);e.posLeft=Math.round(r.position().left);r.remove();if(e.masoned&&o.appendedContent!=undefined){e.colY=q.data("masonry").colY;i=q.data("masonry").colCount}else{e.colY=[];i=0}for(;i<e.colCount;i++)e.colY[i]=e.posTop;o.singleMode?e.$bricks.each(function(){var x=a(this);v(x,e.colCount,e.colY,1,e,o)}):e.$bricks.each(function(){var x=a(this),y=Math.ceil(x.outerWidth(true)/e.colW);y=Math.min(y,e.colCount);if(y==1)v(x,e.colCount,
e.colY,1,e,o);else{var z=e.colCount+1-y,C=[0];for(i=0;i<z;i++)for(j=C[i]=0;j<y;j++)C[i]=Math.max(C[i],e.colY[i+j]);v(x,z,C,y,e,o)}});for(i=e.wallH=0;i<e.colCount;i++)e.wallH=Math.max(e.wallH,e.colY[i]);r={height:e.wallH-e.posTop};e.masoned&&o.animate?q.animate(r,o.duration,o.easing):q.css(r);f.call(e.$bricks);q.data("masonry",e)}return this.each(function(){var q=a(this),o=a.extend({},a.masonry);o.masoned=q.data("masonry")!=undefined;var e=o.masoned?q.data("masonry").options:{},r=a.extend({},o.defaults,
e,m);o.options=r.saveOptions?r:e;f=f||function(){};r.$brickParent=o.masoned&&r.appendedContent!=undefined?r.appendedContent:q;o.$bricks=r.itemSelector==undefined?r.$brickParent.children():r.$brickParent.find(r.itemSelector);if(o.$bricks.length){w(q,r,o);B(q,r,o);e=e.resizeable;!e&&r.resizeable&&a(window).bind("smartresize.masonry",function(){o.masoned=q.data("masonry")!=undefined;var x=q.data("masonry").colCount;w(q,r,o);o.colCount!=x&&B(q,r,o)});e&&!r.resizeable&&a(window).unbind("smartresize.masonry")}else return this})};
a.masonry={defaults:{singleMode:false,columnWidth:undefined,itemSelector:undefined,appendedContent:undefined,saveOptions:true,resizeable:true,animate:false,duration:"normal",easing:"swing"},colW:undefined,colCount:undefined,colY:undefined,wallH:undefined,masoned:undefined,posTop:0,posLeft:0,options:undefined,$bricks:undefined,$brickParent:undefined}})(jQuery);
(function(a){a.extend({tablesorter:new (function(){function b(c,d){m(c+","+((new Date).getTime()-d.getTime())+"ms")}function m(c){typeof console!="undefined"&&typeof console.debug!="undefined"?console.log(c):alert(c)}function f(c,d){if(c.config.debug)var h="";var n=c.tBodies[0].rows;if(c.tBodies[0].rows[0]){var g=[];n=n[0].cells;for(var u=n.length,k=0;k<u;k++){var p=false;if(a.metadata&&a(d[k]).metadata()&&a(d[k]).metadata().sorter)p=v(a(d[k]).metadata().sorter);else if(c.config.headers[k]&&c.config.headers[k].sorter)p=
v(c.config.headers[k].sorter);if(!p)a:{p=n[k];for(var s=A.length,t=1;t<s;t++)if(A[t].is(a.trim(B(c.config,p)),c,p)){p=A[t];break a}p=A[0]}if(c.config.debug)h+="column:"+k+" parser:"+p.id+"\n";g.push(p)}}c.config.debug&&m(h);return g}function v(c){for(var d=A.length,h=0;h<d;h++)if(A[h].id.toLowerCase()==c.toLowerCase())return A[h];return false}function w(c){if(c.config.debug)var d=new Date;for(var h=c.tBodies[0]&&c.tBodies[0].rows.length||0,n=c.tBodies[0].rows[0]&&c.tBodies[0].rows[0].cells.length||
0,g=c.config.parsers,u={row:[],normalized:[]},k=0;k<h;++k){var p=c.tBodies[0].rows[k],s=[];u.row.push(a(p));for(var t=0;t<n;++t)s.push(g[t].format(B(c.config,p.cells[t]),c,p.cells[t]));s.push(k);u.normalized.push(s)}c.config.debug&&b("Building cache for "+h+" rows:",d);return u}function B(c,d){if(!d)return"";var h="";return h=c.textExtraction=="simple"?d.childNodes[0]&&d.childNodes[0].hasChildNodes()?d.childNodes[0].innerHTML:d.innerHTML:typeof c.textExtraction=="function"?c.textExtraction(d):a(d).text()}
function q(c,d){if(c.config.debug)var h=new Date;for(var n=d.row,g=d.normalized,u=g.length,k=g[0].length-1,p=a(c.tBodies[0]),s=[],t=0;t<u;t++){s.push(n[g[t][k]]);if(!c.config.appender)for(var F=n[g[t][k]],E=F.length,D=0;D<E;D++)p[0].appendChild(F[D])}c.config.appender&&c.config.appender(c,s);s=null;c.config.debug&&b("Rebuilt table:",h);e(c);setTimeout(function(){a(c).trigger("sortEnd")},0)}function o(c){if(c.config.debug)var d=new Date;for(var h=[],n=0;n<c.tHead.rows.length;n++)h[n]=0;$tableHeaders=
a("thead th",c);$tableHeaders.each(function(g){this.count=0;this.column=g;var u=c.config.sortInitialOrder;this.order=i=typeof u!="Number"?u.toLowerCase()=="desc"?1:0:u==1?u:0;if(!(u=a.metadata&&a(this).metadata().sorter===false?true:false))u=c.config.headers[g]&&c.config.headers[g].sorter===false?true:false;if(u)this.sortDisabled=true;this.sortDisabled||a(this).addClass(c.config.cssHeader);c.config.headerList[g]=this});if(c.config.debug){b("Built headers:",d);m($tableHeaders)}return $tableHeaders}
function e(c){for(var d=c.config.widgets,h=d.length,n=0;n<h;n++)r(d[n]).format(c)}function r(c){for(var d=G.length,h=0;h<d;h++)if(G[h].id.toLowerCase()==c.toLowerCase())return G[h]}function x(c,d){for(var h=d.length,n=0;n<h;n++)if(d[n][0]==c)return true;return false}function y(c,d,h,n){d.removeClass(n[0]).removeClass(n[1]);var g=[];d.each(function(){this.sortDisabled||(g[this.column]=a(this))});c=h.length;for(d=0;d<c;d++)g[h[d][0]].addClass(n[h[d][1]])}function z(c){if(c.config.widthFixed){var d=
a("<colgroup>");a("tr:first td",c.tBodies[0]).each(function(){d.append(a("<col>").css("width",a(this).width()))});a(c).prepend(d)}}function C(c,d,h){if(c.config.debug)var n=new Date;for(var g="var sortWrapper = function(a,b) {",u=d.length,k=0;k<u;k++){var p=d[k][0],s=d[k][1],t="e"+k;g+="var "+t+" = "+(c.config.parsers[p].type=="text"?s==0?"sortText":"sortTextDesc":s==0?"sortNumeric":"sortNumericDesc")+"(a["+p+"],b["+p+"]); ";g+="if("+t+") { return "+t+"; } ";g+="else { "}k=h.normalized[0].length-
1;g+="return a["+k+"]-b["+k+"];";for(k=0;k<u;k++)g+="}; ";g+="return 0; ";g+="}; ";eval(g);h.normalized.sort(sortWrapper);c.config.debug&&b("Sorting on "+d.toString()+" and dir "+s+" time:",n);return h}var A=[],G=[];this.defaults={cssHeader:"header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,textExtraction:"simple",parsers:{},widgets:[],widgetZebra:{css:["even","odd"]},headers:{},widthFixed:false,cancelSelection:true,
sortList:[],headerList:[],dateFormat:"us",decimal:".",debug:false};this.benchmark=b;this.construct=function(c){return this.each(function(){if(this.tHead&&this.tBodies){var d,h,n,g;this.config={};g=a.extend(this.config,a.tablesorter.defaults,c);d=a(this);h=o(this);this.config.parsers=f(this,h);n=w(this);var u=[g.cssDesc,g.cssAsc];z(this);h.click(function(k){d.trigger("sortStart");var p=d[0].tBodies[0]&&d[0].tBodies[0].rows.length||0;if(!this.sortDisabled&&p>0){a(this);p=this.column;this.order=this.count++%
2;if(k[g.sortMultiSortKey])if(x(p,g.sortList))for(k=0;k<g.sortList.length;k++){var s=g.sortList[k],t=g.headerList[s[0]];if(s[0]==p){t.count=s[1];t.count++;s[1]=t.count%2}}else g.sortList.push([p,this.order]);else{g.sortList=[];if(g.sortForce!=null){s=g.sortForce;for(k=0;k<s.length;k++)s[k][0]!=p&&g.sortList.push(s[k])}g.sortList.push([p,this.order])}setTimeout(function(){y(d[0],h,g.sortList,u);q(d[0],C(d[0],g.sortList,n))},1);return false}}).mousedown(function(){if(g.cancelSelection){this.onselectstart=
function(){return false};return false}});d.bind("update",function(){this.config.parsers=f(this,h);n=w(this)}).bind("sorton",function(k,p){a(this).trigger("sortStart");g.sortList=p;for(var s=g.sortList,t=this.config,F=s.length,E=0;E<F;E++){var D=s[E],H=t.headerList[D[0]];H.count=D[1];H.count++}y(this,h,s,u);q(this,C(this,s,n))}).bind("appendCache",function(){q(this,n)}).bind("applyWidgetId",function(k,p){r(p).format(this)}).bind("applyWidgets",function(){e(this)});if(a.metadata&&a(this).metadata()&&
a(this).metadata().sortlist)g.sortList=a(this).metadata().sortlist;g.sortList.length>0&&d.trigger("sorton",[g.sortList]);e(this)}})};this.addParser=function(c){for(var d=A.length,h=true,n=0;n<d;n++)if(A[n].id.toLowerCase()==c.id.toLowerCase())h=false;h&&A.push(c)};this.addWidget=function(c){G.push(c)};this.formatFloat=function(c){c=parseFloat(c);return isNaN(c)?0:c};this.formatInt=function(c){c=parseInt(c);return isNaN(c)?0:c};this.isDigit=function(c,d){var h="\\"+d.decimal;return RegExp("/(^[+]?0("+
h+"0+)?$)|(^([-+]?[1-9][0-9]*)$)|(^([-+]?((0?|[1-9][0-9]*)"+h+"(0*[1-9][0-9]*)))$)|(^[-+]?[1-9]+[0-9]*"+h+"0+$)/").test(a.trim(c))};this.clearTableBody=function(c){if(a.browser.msie)(function(){for(;this.firstChild;)this.removeChild(this.firstChild)}).apply(c.tBodies[0]);else c.tBodies[0].innerHTML=""}})});a.fn.extend({tablesorter:a.tablesorter.construct});var l=a.tablesorter;l.addParser({id:"text",is:function(){return true},format:function(b){return a.trim(b.toLowerCase())},type:"text"});l.addParser({id:"digit",
is:function(b,m){return a.tablesorter.isDigit(b,m.config)},format:function(b){return a.tablesorter.formatFloat(b)},type:"numeric"});l.addParser({id:"currency",is:function(b){return/^[\u00ac\u00a3$\u201a\u00c7\u00a8?.]/.test(b)},format:function(b){return a.tablesorter.formatFloat(b.replace(new RegExp(/[^0-9.]/g),""))},type:"numeric"});l.addParser({id:"ipAddress",is:function(b){return/^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(b)},format:function(b){b=b.split(".");for(var m="",f=b.length,v=0;v<
f;v++){var w=b[v];m+=w.length==2?"0"+w:w}return a.tablesorter.formatFloat(m)},type:"numeric"});l.addParser({id:"url",is:function(b){return/^(https?|ftp|file):\/\/$/.test(b)},format:function(b){return jQuery.trim(b.replace(new RegExp(/(https?|ftp|file):\/\//),""))},type:"text"});l.addParser({id:"isoDate",is:function(b){return/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(b)},format:function(b){return a.tablesorter.formatFloat(b!=""?(new Date(b.replace(new RegExp(/-/g),"/"))).getTime():"0")},type:"numeric"});
l.addParser({id:"percent",is:function(b){return/\%$/.test(a.trim(b))},format:function(b){return a.tablesorter.formatFloat(b.replace(new RegExp(/%/g),""))},type:"numeric"});l.addParser({id:"usLongDate",is:function(b){return b.match(new RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/))},format:function(b){return a.tablesorter.formatFloat((new Date(b)).getTime())},type:"numeric"});l.addParser({id:"shortDate",is:function(b){return/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(b)},
format:function(b,m){var f=m.config;b=b.replace(/\-/g,"/");if(f.dateFormat=="us")b=b.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2");else if(f.dateFormat=="uk")b=b.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1");else if(f.dateFormat=="dd/mm/yy"||f.dateFormat=="dd-mm-yy")b=b.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3");return a.tablesorter.formatFloat((new Date(b)).getTime())},type:"numeric"});l.addParser({id:"time",is:function(b){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(b)},
format:function(b){return a.tablesorter.formatFloat((new Date("2000/01/01 "+b)).getTime())},type:"numeric"});l.addParser({id:"metadata",is:function(){return false},format:function(b,m,f){b=m.config;b=!b.parserMetadataName?"sortValue":b.parserMetadataName;return a(f).metadata()[b]},type:"numeric"});l.addWidget({id:"zebra",format:function(b){if(b.config.debug)var m=new Date;a("tr:visible",b.tBodies[0]).filter(":even").removeClass(b.config.widgetZebra.css[1]).addClass(b.config.widgetZebra.css[0]).end().filter(":odd").removeClass(b.config.widgetZebra.css[0]).addClass(b.config.widgetZebra.css[1]);
b.config.debug&&a.tablesorter.benchmark("Applying Zebra widget",m)}})})(jQuery);
